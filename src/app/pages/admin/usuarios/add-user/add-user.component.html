<div class="container">
  <app-header></app-header>

  <div class="card-form">
    <h2>Registrar nuevo trabajador</h2>

    <form #form="ngForm" (ngSubmit)="formSubmit(form)" novalidate>
      <div class="form-grid-2cols">

        <!-- Columna 1: Imagen -->
        <div class="form-column">
          <div class="form-image-upload">
            <img [src]="imagenPrevia || 'assets/subir.jpg'" alt="Foto del trabajador" />
            <input type="file" (change)="onFileSelected($event)" />
          </div>
        </div>

        <!-- Columna 2: Campos del formulario -->
        <div class="form-column form-fields">
          <mat-form-field appearance="outline">
            <mat-label>Nombre</mat-label>
            <input matInput required [(ngModel)]="user.nombre" name="nombre" placeholder="Digite su nombre" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Apellido</mat-label>
            <input matInput required [(ngModel)]="user.apellidos" name="apellido" placeholder="Digite sus apellidos" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Nombre de usuario</mat-label>
            <input matInput required [(ngModel)]="user.username" name="username" placeholder="Digite su usuario" />
            <mat-hint>Debe ser único</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Contraseña</mat-label>
            <input
              matInput
              required
              [(ngModel)]="user.password"
              name="password"
              [type]="mostrarPassword ? 'text' : 'password'"
              placeholder="Contraseña"
            />
            <button mat-icon-button matSuffix type="button" (click)="mostrarPassword = !mostrarPassword">
              <mat-icon>{{ mostrarPassword ? 'visibility' : 'visibility_off' }}</mat-icon>
            </button>
            <button mat-icon-button matSuffix type="button" (click)="generarContrasena()" aria-label="Generar contraseña">
              <mat-icon>autorenew</mat-icon>
            </button>
            <mat-hint>Mín. 8 caracteres con mayúscula, minúscula, número y símbolo</mat-hint>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input matInput type="email" required [(ngModel)]="user.email" name="email" placeholder="Digite su correo" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Teléfono</mat-label>
            <input matInput required [(ngModel)]="user.telefono" name="telefono" placeholder="Digite su teléfono" />
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Rol</mat-label>
            <mat-select name="rol" [(ngModel)]="rolSeleccionado" required>
              <mat-option *ngFor="let rol of roles" [value]="rol.id">
                {{ rol.nombreRol }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>

      <div class="form-actions">
        <button mat-raised-button color="primary" [disabled]="!form.valid">Registrar</button>
        <button mat-stroked-button color="warn" type="button">Cancelar</button>
        <button mat-flat-button color="accent" type="reset">Limpiar</button>
      </div>
    </form>
  </div>
</div>
