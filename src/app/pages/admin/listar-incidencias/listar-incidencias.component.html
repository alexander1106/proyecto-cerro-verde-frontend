<div class="container mt-4">
  <h2 class="mb-3">Lista de Incidencias</h2>
<button class="btn btn-primary mb-3" (click)="abrirModal()">Registrar Nueva Incidencia</button>

  <div *ngIf="loading" class="alert alert-info">Cargando incidencias...</div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>

  <table *ngIf="!loading && !error" class="table table-bordered table-striped">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Fecha Registro</th>
        <th>Fecha Solución</th>
        <th>Estado</th>
        <th>Descripción</th>
        <th>Habitación</th>
        <th>Tipo</th>
        <th>Usuario</th>
        <th>Área</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let incidencia of incidencias">
        <td>{{ incidencia.id_incidencia }}</td>
        <td>{{ incidencia.fecha_registro }}</td>
        <td>{{ incidencia.fecha_solucion || 'Pendiente' }}</td>
        <td>{{ incidencia.estado_incidencia }}</td>
        <td>{{ incidencia.descripcion }}</td>
        <td>{{ incidencia.habitacion?.numero || 'N/A' }}</td>
        <td>{{ incidencia.tipoIncidencia?.nombre || 'N/A' }}</td>
        <td>{{ incidencia.usuario?.nombre || 'N/A' }}</td>
        <td>{{ incidencia.area?.nombre || 'N/A' }}</td>
      </tr>
    </tbody>
  </table>
</div>

<p *ngIf="mostrarModal">✅ Modal Activo</p>
<app-registrar-incidencia
  *ngIf="mostrarModal"
  (onRegistroExitoso)="registroExitoso()"
  (onCancelar)="cerrarModal()">
</app-registrar-incidencia>

